(this.webpackJsonpaudio_bot_app=this.webpackJsonpaudio_bot_app||[]).push([[0],{159:function(e,t,a){e.exports=a(250)},249:function(e,t,a){},250:function(e,t,a){"use strict";a.r(t);a(160),a(186),a(188),a(189),a(191),a(192),a(193),a(194),a(195),a(196),a(197),a(198),a(200),a(201),a(202),a(203),a(204),a(205),a(206),a(207),a(208),a(209),a(211),a(212),a(213),a(214),a(215),a(216),a(217),a(218),a(219),a(220),a(221),a(222),a(223),a(224),a(225),a(226),a(227),a(228);var n=a(0),r=a.n(n),c=a(84),s=a.n(c),i=a(18),o=a.n(i),l=a(25),u=a.n(l),d=a(38),h=a(85),m=a(86),p=a(96),f=a(95),k=a(12),g=a(42),b=a.n(g),v=(a(248),a(249),function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).pickedTracks=[],n.vkId=null,n.telegramId=null,n.permission=!0,n.hash=null,n.icon="data:image/svg+xml;charset=utf-8,%3Csvg%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22m0%200h24v24h-24z%22%20opacity%3D%22.4%22%2F%3E%3Cpath%20d%3D%22m13%2011.4849987v5.6482897c0%204.5123987-.8747233%205.3834431-4.37440289%205.8421935-1.6682259.2186769-3.62559711-.5384568-3.62559711-3.1617096%200-1.2814037.80181302-2.498263%202.46114282-2.8162494%201.26723039-.2428462-.09078118.0181935%202.77607228-.5140396.6959753-.1292083.7748413-.3782301.7748413-.908791%200-.2664094-.0013183-2.5951438-.0022416-4.1936475l-.0073943-.0003862v-4.31781414s-.0054461-2.05827203%200-3.08739758c.0065136-1.23086488.6796458-1.68321833%202.6637921-2.08397579%200%200%203.0232113-.57396781%204.6852252-.87541989.367783-.06670761.6485622.07018054.6485622.49202579%200%200-.0106774%202.62210108%200%204.05433854.0031006.41590408-.168424.60420104-.5899711.67902227-1.6816987.29848801-4.8649278.86036181-4.8649278.86036181-.3738792.09182758-.5451011.35499958-.5451011.73329156z%22%20fill%3D%22%236f99c8%22%20fill-rule%3D%22nonzero%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E",n.API_URL="https://s23209.h10.modhost.pro",n.refs=[],n.setSnackbar=function(){n.setState({snackbar:r.a.createElement(k.o,{layout:"vertical",onClose:function(){return n.setState({snackbar:null})},before:r.a.createElement(k.a,{size:24,style:{backgroundColor:"var(--accent)"}},r.a.createElement(b.a,{fill:"#fff",width:14,height:14}))},"\u041c\u0443\u0437\u044b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b\u0430\u0441\u044c. \u041f\u0440\u0438\u044f\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u043d\u0438\u044f \ud83c\udfa7")})},n.onCheckboxChange=function(e){var t=JSON.parse(e.currentTarget.dataset.track);n.pickedTracks[t.index]=n.pickedTracks[t.index]?null:{url:t.url,title:t.title,artist:t.artist}},n.sendTracks=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.permission){e.next=5;break}return e.next=3,o.a.send("VKWebAppJoinGroup",{group_id:184374271}).then((function(e){return n.permission=e.result})).catch((function(){return n.permission=!1}));case 3:return e.abrupt("return",e.sent);case 5:if(n.telegramId){e.next=10;break}return e.next=8,fetch("".concat(n.API_URL,"/getHash?id=").concat(n.vkId)).then((function(e){return e.json()}));case 8:return n.hash=e.sent.hash,e.abrupt("return",n.setActiveModal("TelegramAuth"));case 10:t=n.filteredPickedTracks(),n.setSnackbar(),fetch("".concat(n.API_URL,"/sendTracks?id=").concat(n.telegramId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 13:case"end":return e.stop()}}),e)}))),n.setActiveModal=function(e){n.setState({activeModal:e})},n.filteredPickedTracks=function(){return n.pickedTracks.filter((function(e){return!!e}))},n.state={scheme:"bright_light",tracks:[],activeModal:null,snackbar:null,isShowButton:!1,isLoading:!0,isAllChecked:!1},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.a.subscribe(function(){var e=Object(d.a)(u.a.mark((function e(a){var r,c,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.detail,c=r.type,s=r.data,"VKWebAppUpdateConfig"!==c){e.next=5;break}t.setState({scheme:s.scheme}),e.next=31;break;case 5:if("VKWebAppInitResult"!==c){e.next=31;break}return e.next=8,o.a.send("VKWebAppGetUserInfo",{});case 8:return t.vkId=e.sent.id,e.next=11,o.a.send("VKWebAppJoinGroup",{group_id:184374271}).then((function(e){return t.permission=e.result})).catch((function(){return t.permission=!1}));case 11:return e.next=13,o.a.send("VKWebAppStorageGet",{keys:["telegramId"]});case 13:if(t.telegramId=e.sent.keys[0].value,console.log(t.telegramId),"null"!==t.telegramId){e.next=30;break}return e.next=18,fetch("".concat(t.API_URL,"/getUser?id=").concat(t.vkId)).then((function(e){return e.json()}));case 18:if(i=e.sent,t.telegramId=i.telegramId,console.log(t.telegramId),t.telegramId){e.next=28;break}return e.next=24,fetch("".concat(t.API_URL,"/getHash?id=").concat(t.vkId)).then((function(e){return e.json()}));case 24:t.hash=e.sent.hash,t.setActiveModal("TelegramAuth"),e.next=30;break;case 28:return e.next=30,o.a.send("VKWebAppStorageSet",{key:"telegramId",value:"".concat(t.telegramId)});case 30:fetch("".concat(t.API_URL,"/getTracks?id=").concat(t.vkId)).then((function(e){return e.json()})).then((function(e){t.pickedTracks=new Array(e.tracks.length),t.refs=t.pickedTracks.map((function(){return Object(n.createRef)()})),t.setState({tracks:e.tracks,isLoading:!1})}));case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement(k.i,{activeModal:this.state.activeModal,onClose:this.modalBack},r.a.createElement(k.h,{id:"TelegramAuth",onClose:function(){return e.setActiveModal(null)},header:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0441\u044f \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u0435",caption:"\u0427\u0442\u043e\u0431\u044b \u044f \u0441\u043c\u043e\u0433 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0442\u0435\u0431\u0435 \u0442\u0440\u0435\u043a \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c, \u0442\u0435\u0431\u0435 \u043d\u0443\u0436\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u043d\u0435\u043c"},r.a.createElement(k.b,{style:{marginTop:16},mode:"secondary",size:"xl",href:"https://t.me/ilushaR_bot?start=".concat(this.vkId,"-").concat(this.hash),target:"_blank"},"Telegram Authorization \ud83d\udd13")));return r.a.createElement(k.e,{scheme:this.state.scheme},r.a.createElement(k.q,{activePanel:"main",modal:t},r.a.createElement(k.j,{id:"main"},r.a.createElement(k.k,{left:r.a.createElement(k.l,{onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))},this.state.isAllChecked?"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c":"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"," \u0432\u0441\u0435")},"Audio Bot"),this.state.isLoading?r.a.createElement(k.p,{size:"large",style:{marginTop:20}}):r.a.createElement(k.f,{style:{marginBottom:this.state.isShowButton?40:0}},this.state.tracks.map((function(t,a){return r.a.createElement(k.n,{key:t.id,before:r.a.createElement(k.c,{size:"m",style:{width:40,height:40,marginRight:10,background:"url(".concat(t.album&&t.album.thumb?t.album.thumb.photo_68:e.icon,") no-repeat center #e5ebf1"),backgroundSize:"cover"}}),after:r.a.createElement(k.d,{"data-track":JSON.stringify({index:a,url:t.url,title:t.title,artist:t.artist}),onChange:e.onCheckboxChange}),description:t.artist},t.title)}))),this.state.isShowButton&&r.a.createElement(k.g,{vertical:"bottom"},r.a.createElement(k.m,{wide:!0}),r.a.createElement(k.b,{onClick:this.sendTracks,size:"xl"},"\u0421\u043a\u0430\u0447\u0430\u0442\u044c")),this.state.snackbar)))}}]),a}(r.a.Component));o.a.send("VKWebAppInit"),s.a.render(r.a.createElement(v,null),document.getElementById("root"))}},[[159,1,2]]]);
//# sourceMappingURL=main.b607b140.chunk.js.map